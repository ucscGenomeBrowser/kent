# for emacs: -*- mode: sh; -*-

#	Caenorhabditis PB2801
#	This is the actual name, it is sometimes known as:
#	Caenorhabditis n. sp. PB2801
#	From Wash U GSC
#	http://genome.wustl.edu/genome.cgi?GENOME=Caenorhabditis+n.+sp.+PB2801


#########################################################################
# DOWNLOAD SEQUENCE (DONE - 2007-02-16 - Hiram)
    ssh kkstore01
    mkdir /cluster/store10/caePb1
    ln -s /cluster/store10/caePb1 /cluster/data/caePb1

    cd /cluster/data/caePb1
    mkdir downloads
    cd downloads
    wget --timestamping \
"ftp://genome.wustl.edu/pub/organism/Invertebrates/Caenorhabditis_PB2801/assembly/draft/Caenorhabditis_PB2801-4.0/ASSEMBLY"

    wget --timestamping \
"ftp://genome.wustl.edu/pub/organism/Invertebrates/Caenorhabditis_PB2801/assembly/draft/Caenorhabditis_PB2801-4.0/README" -O README.caePb1

    wget --timestamping -m -nd -np \
"ftp://genome.wustl.edu/pub/organism/Invertebrates/Caenorhabditis_PB2801/assembly/draft/Caenorhabditis_PB2801-4.0/output/"

    #	Going to manipulate the given supercontigs.agp.gz file to produce a
    #	chrUn.agp.gz file, although this ends up being too detailed.  A second
    #	super.lift and gold.tab will also be produced to get the chrUn_gold
    #	table loaded with appropriate supercontigs without all the bridged
    #	gaps.  This first chrUn.agp.gz file will be used with the initial
    #	build so that the gap table will be constructed properly with all the
    #	bridged gaps.
    faCount contigs.fa.gz > faCount.contigs.fa.txt
    mkdir ../jkStuff
    cat << '_EOF_' > ../jkStuff/mkChrUnAgp.pl
#!/usr/bin/env perl

use strict;
use warnings;

my $start = 1;
my $end = 1;
my $itemCount = 1;
my $curContig = "";
my $firstTime = 1;
my $scaffoldGapSize = 1000;

open (FH,'zcat supercontigs.agp.gz|') or
        die "can not open zcat supercontigs.agp.gz";
while (my $line=<FH>) {
    chomp $line;
    if ($line =~ m/fragment/) {
        my ($name, $gStart, $gEnd, $counter, $WN, $gapLen, $frag, $yesNo) =
            split('\s+',$line);
        $end = $start + $gapLen - 1;
        printf "chrUn\t%d\t%d\t%d\t%s\t%d\t%s\t%s\n",
                    $start, $end, $itemCount++, $WN, $gapLen, $frag, $yesNo;
        $start = $end + 1;
    } else {
    my ($ctgName, $ctgStart, $ctgEnd, $counter, $WN, $name, $cStart, $cEnd, $strand) =
        split('\s+',$line);
        my $ctgLen = $ctgEnd - $ctgStart + 1;
        my $cLen = $cEnd - $cStart + 1;
        die "not matching start, end:\n$line" if ($ctgLen != $cLen);
        if (!$firstTime) {
            if ($ctgName ne $curContig) {
                $end = $start + $scaffoldGapSize - 1;
                printf "chrUn\t%d\t%d\t%d\tN\t%d\tscaffold\tno\n",
                    $start, $end, $itemCount++, $scaffoldGapSize;
                $start = $end + 1;
            }
        } else {
            $firstTime = 0;
        }
        $end = $start + $ctgLen - 1;
        printf "chrUn\t%d\t%d\t%d\t%s\t%s\t%d\t%d\t%s\n",
                $start, $end, $itemCount++, $WN, $name,
                $cStart, $cEnd, $strand;
        $start = $end + 1;
        $curContig = $ctgName;
    }
}
close (FH);
'_EOF_'
# << happy emacs
    chmod +x ../jkStuff/mkChrUnAgp.pl
    ../jkStuff/mkChrUnAgp.pl | gzip > chrUn.agp.gz
    qaToQac contigs.fa.qual.gz stdout \
        | qacAgpLift chrUn.agp.gz stdin chrUn.qac

##########################################################################
## Initial database construction and beginning tables
##	(DONE - 2007-03-01 - Hiram)

    ssh kkstore01
    cd /cluster/data/caePb1
    cat << '_EOF_' > caePb1.config.ra
# Config parameters for makeGenomeDb.pl:
db caePb1
clade worm
genomeCladePriority 66
scientificName Caenorhabditis PB2801
commonName C. PB2801
assemblyDate Jan. 2007
assemblyLabel Washington University School of Medicine GSC Caenorhabditis n. sp. PB2801
orderKey 876
mitoAcc none
fastaFiles /cluster/data/caePb1/downloads/supercontigs.fa.gz
agpFiles /cluster/data/caePb1/downloads/scaffold.agp.gz
qualFiles /cluster/data/caePb1/downloads/chrUn.qac
dbDbSpeciesDir worm
'_EOF_'
# << happy emacs

    time makeGenomeDb.pl -verbose=2 caePb1.config.ra > makeGenomeDb.out 2>&1

##########################################################################
##  Fixup chrUn_gold table, and add ctgPos2 table

    ssh kkstore01
    cd /cluster/data/caePb1/downloads

    #	create a ctgPos2.tab table
    cat << '_EOF_' > ../jkStuff/mkScafAgp.pl
#!/usr/bin/env perl

use strict;
use warnings;

my $start = 1;
my $end = 1;
my $itemCount = 1;
my $curContig = "";
my $firstTime = 1;
my $scaffoldGapSize = 1000;
my $scafEnd = 1;

open (CT,">ctgPos2.tab") or die "can not write to ctgPos2.tab";

open (FH,'zcat supercontigs.agp.gz|') or
        die "can not open zcat supercontigs.agp.gz";
while (my $line=<FH>) {
    chomp $line;
    if ($line =~ m/fragment/) {
        my ($name, $gStart, $gEnd, $counter, $WN, $gapLen, $frag, $yesNo) =
            split('\s+',$line);
        $end = $start + $gapLen - 1;
        $scafEnd += $gapLen;
        printf "chrUn\t%d\t%d\t%d\t%s\t%d\t%s\t%s\n",
                    $start, $end, $itemCount++, $WN, $gapLen, $frag, $yesNo;
        $start = $end + 1;
    } else {
    my ($ctgName, $ctgStart, $ctgEnd, $counter, $WN, $name, $cStart, $cEnd, $strand) =
        split('\s+',$line);
        my $ctgLen = $ctgEnd - $ctgStart + 1;
        my $cLen = $cEnd - $cStart + 1;
        die "not matching start, end:\n$line" if ($ctgLen != $cLen);
        if (!$firstTime) {
            if ($ctgName ne $curContig) {
                $end = $start + $scaffoldGapSize - 1;
                printf "chrUn\t%d\t%d\t%d\tN\t%d\tscaffold\tno\n",
                    $start, $end, $itemCount++, $scaffoldGapSize;
                $start = $end + 1;
                $scafEnd = $cStart - 1;
            }
        } else {
            $firstTime = 0;
            $scafEnd = 0;
        }
        $scafEnd += $ctgLen;
        my $fragStart = $scafEnd - $ctgLen + 1;
        $end = $start + $ctgLen - 1;
        printf "chrUn\t%d\t%d\t%d\t%s\t%s\t%d\t%d\t%s\n",
                $start, $end, $itemCount++, $WN, $ctgName,
                $fragStart, $scafEnd, $strand;
        printf CT "%s\t%d\tchrUn\t%d\t%d\tW\n",
                $name, $ctgLen, $start-1, $end;
        $start = $end + 1;
        $curContig = $ctgName;
    }
}
close (FH);
close (CT);
'_EOF_"
# << happy emacs
    chmod +x ../jkStuff/mkScafAgp.pl
    nice -n +19 ../jkStuff/mkScafAgp.pl

    ##	and load that ctgPos2 table:
    ssh hgwdev
    cd /cluster/data/caePb1/downloads
    hgLoadSqlTab caePb1 ctgPos2 ~/kent/src/hg/lib/ctgPos2.sql ctgPos2.tab

    ##  and the super.lift to get supercontigs lifted to chrUn
    ssh kkstore01
    cd /cluster/data/caePb1/downloads
    
    cat << '_EOF_' > ../jkStuff/mkSuperLift.pl
#!/usr/bin/env perl

use strict;
use warnings;

my $start = 1;
my $end = 1;
my $itemCount = 1;
my $curContig = "";
my $firstTime = 1;
my $scaffoldGapSize = 1000;
my $scafEnd = 1;
my $superStart = 0;
my $superEnd = 1;
my $superLength = 0;
my $chrUnSize = 207333000;
my $chrUnName = "chrUn";

open (GL,">gold.tab") or die "Can not write to gold.tab";

open (FH,'zcat supercontigs.agp.gz|') or
        die "can not open zcat supercontigs.agp.gz";
while (my $line=<FH>) {
    chomp $line;
    if ($line =~ m/fragment/) {
        my ($name, $gStart, $gEnd, $counter, $WN, $gapLen, $frag, $yesNo) =
            split('\s+',$line);
        $end = $start + $gapLen - 1;
        $scafEnd += $gapLen;
#       printf "chrUn\t%d\t%d\t%d\t%s\t%d\t%s\t%s\n",
#                   $start, $end, $itemCount++, $WN, $gapLen, $frag, $yesNo;
        $start = $end + 1;
    } else {
    my ($ctgName, $ctgStart, $ctgEnd, $counter, $WN, $name, $cStart, $cEnd, $strand) =
        split('\s+',$line);
        my $ctgLen = $ctgEnd - $ctgStart + 1;
        my $cLen = $cEnd - $cStart + 1;
        die "not matching start, end:\n$line" if ($ctgLen != $cLen);
        if (!$firstTime) {
            if ($ctgName ne $curContig) {
                $superLength = $superEnd - $superStart;
                $end = $start + $scaffoldGapSize - 1;
#               printf "chrUn\t%d\t%d\t%d\tN\t%d\tscaffold\tno\n",
#                   $start, $end, $itemCount++, $scaffoldGapSize;
                printf "%d\t%s\t%d\t%s\t%d\n",
                        $superStart, $curContig, $superLength, $chrUnName,
                                $chrUnSize;
                printf GL "%s\t%d\t%d\t%d\tW\t%s\t0\t%d\t+\n",
                        $chrUnName, $superStart, $superEnd, $itemCount++,
                        $curContig, $superLength;
                $start = $end + 1;
                $scafEnd = $cStart - 1;
                $superStart = $start - 1;
            }
        } else {
            $firstTime = 0;
            $scafEnd = 0;
        }
        $scafEnd += $ctgLen;
        my $fragStart = $scafEnd - $ctgLen + 1;
        $end = $start + $ctgLen - 1;
        $superEnd = $end;
#       printf "chrUn\t%d\t%d\t%d\t%s\t%s\t%d\t%d\t%s\n",
#               $start, $end, $itemCount++, $WN, $ctgName,
#               $fragStart, $scafEnd, $strand;
#       printf SL "%s\t%d\tchrUn\t%d\t%d\tW\n",
#               $name, $ctgLen, $start-1, $end;
        $start = $end + 1;
        $curContig = $ctgName;
    }
}
close (FH);
$superLength = $superEnd - $superStart;
printf "%d\t%s\t%d\t%s\t%d\n",
    $superStart, $curContig, $superLength, $chrUnName, $chrUnSize;
printf GL "%s\t%d\t%d\t%d\tW\t%s\t0\t%d\t+\n",
        $chrUnName, $superStart, $superEnd, $itemCount++,
        $curContig, $superLength;
close (GL);
'_EOF_'
# << happy emacs
    chmod +x ../jkStuff/mkSuperLift.pl

    nice -n +19 ../jkStuff/mkSuperLift.pl > super.lift

    ##	and load that ctgPos2 table:

    ssh hgwdev
    cd /cluster/data/caePb1/downloads
    sed -e "s/agpFrag/chrUn_gold/" $HOME/kent/src/hg/lib/agpFrag.sql \
	> chrUn_gold.sql
    # edit that .sql file to add the bin column
    #	 bin smallint(6) NOT NULL default '0',

    hgLoadBed -sqlTable=chrUn_gold.sql caePb1 chrUn_gold gold.tab

##############################################################################
## Repeat Masker does not recognize given species:
#	Species "Caenorhabditis PB2801" is not known to RepeatMasker.

##############################################################################
## WindowMasker masking (DONE - 2007-03-02 - Hiram)
    ssh kolossus
    mkdir /cluster/data/caePb1/bed/WindowMasker
    cd /cluster/data/caePb1/bed/WindowMasker
    time nice -n +19 ~/kent/src/hg/utils/automation/doWindowMasker.pl \
	caePb1 -buildDir=/cluster/data/caePb1/bed/WindowMasker \
	    -workhorse=kolossus > doWM.out 2>&1 &
    ## load result
    ssh hgwdev
    cd /cluster/data/caePb1/bed/WindowMasker
    hgLoadBed -strict caePb1 windowmaskerSdust windowmasker.sdust.bed.gz

##############################################################################
## simpleRepeat masking (DONE - 2007-03-02 - Hiram)
    ssh kolossus
    mkdir /cluster/data/caePb1/bed/simpleRepeat
    cd /cluster/data/caePb1/bed/simpleRepeat
    nice -n +19 twoBitToFa ../../caePb1.unmasked.2bit stdout \
	| trfBig -trf=/cluster/bin/i386/trf stdin /dev/null \
		-bedAt=simpleRepeat.bed -tempDir=/scratch/tmp
    awk '{if ($5 <= 12) print;}' simpleRepeat.bed > trfMask.bed

    ssh hgwdev
    cd /cluster/data/caePb1/bed/simpleRepeat
    nice -n +19 hgLoadBed caePb1 simpleRepeat \
      simpleRepeat.bed -sqlTable=$HOME/kent/src/hg/lib/simpleRepeat.sql

    featureBits caePb1 simpleRepeat
    #	4938308 bases of 175247318 (2.818%) in intersection

##############################################################################
## combine trf mask with windowmasker (DONE - 2007-03-03 - Hiram)
    ssh kkstore02
    cd /cluster/data/caePb1
    cat << '_EOF_' > addTrf.csh
#!/bin/csh -efx
# This script will fail if any of its commands fail.

set DB = caePb1
set WORK_DIR = /cluster/data/${DB}
set WM_DIR = /cluster/data/${DB}/bed/WindowMasker
cd ${WORK_DIR}
set inputTwoBit = ${WM_DIR}/${DB}.wmsk.sdust.2bit
set tmpTwoBit = ${WM_DIR}/${DB}.sdTrf.n.2bit
set outputTwoBit = ${WORK_DIR}/${DB}.sdTrf.2bit
cat /cluster/data/${DB}/bed/simpleRepeat/trfMask.bed \
        | twoBitMask -add -type=.bed ${inputTwoBit} stdin ${tmpTwoBit}
twoBitToFa ${tmpTwoBit} stdout | sed -e "s/n/N/g" \
        | sed -e "s/chrUN/chrUn/" | faToTwoBit stdin ${outputTwoBit}
twoBitToFa ${outputTwoBit} stdout | faSize -showPercent stdin \
        > faSize.${DB}.sdTrf.txt
rm -f ${tmpTwoBit}
cat faSize.${DB}.sdTrf.txt
'_EOF_'
# << happy emacs
    chmod +x ./addTrf.csh
    nice -n +19 ./addTrf.csh
    #	produces this masked file:
    # 	-rw-rw-r--  1 63185508 Mar  3 09:18 caePb1.sdTrf.2bit
    #	faSize -showPercent on it indicates:
    #	207333000 bases (32085682 N's 175247318 real
    #	124302731 upper 50944587 lower) in 1 sequences in 1 files
    #	%24.57 masked total, %29.07 masked real

##############################################################################
## create masked contigs for blastz (DONE - 2007-03-04 - Hiram)
    ssh kkstore02
    mkdir /cluster/data/caePb1/maskedContigs
    cd /cluster/data/caePb1/maskedContigs
    ln -s ../downloads/super.lift .
    #	copy over lft2BitToFa.pl from /cluster/data/gasAcu1/jkStuff
    ../jkStuff/lft2BitToFa.pl ../caePb1.2bit super.lift > super.fa
    faToTwoBit super.fa caePb1.supercontigs.sdTrf.2bit
    twoBitInfo caePb1.supercontigs.sdTrf.2bit stdout | sort -k2nr \
        > caePb1.supercontigs.sizes
    #	Copy this 2bit file and sizes over to /san/sanvol1/scratch/worms/caePb1

    #  the lft2BitToFa.pl script is:
    cat << '_EOF_'
#!/usr/bin/env perl

use strict;
use warnings;
use File::Basename;
    
sub usage()
{
printf "usage: %s <file.2bit> <file.lft> [more_files.lft]\n",  basename($0);
printf "\tfasta output is to stdout, therefore route stdout to result file\n";
exit 255;
}   
    
my $argc = scalar(@ARGV);

usage if ($argc < 2);

my $twoBitFile = shift;
    
while (my $liftFile = shift)
{   
open (FH,"<$liftFile") or die "Can not open $liftFile";
while (my $line=<FH>)
    {
    chomp $line;
    my ($start, $contig, $length, $chrom, $chrom_length) = split('\s',$line);
    my $cmd=sprintf("twoBitToFa $twoBitFile:%s:%d-%d stdout",
        $chrom, $start, $start+$length);
    print `$cmd | sed -e "s#^>.*#>$contig#"`;
    }
close (FH);
}
'_EOF_'
# << happy emacs

############################################################################
## Default position (DONE - 2007-04-09 - Hiram)
    ssh hgwdev
    hgsql -e 'update dbDb set defaultPos="chrUn:123456-234567"
	where name="caePb1";' hgcentraltest

############################################################################
##  SWAP cb3 alignments (DONE - 2007-04-18 - Hiram)
    ssh kkstore01
    cd /cluster/data/cb3/bed/blastz.caePb1.2007-04-18
    cat fb.cb3.chainCaePb1Link.txt
    #	42772225 bases of 108433446 (39.446%) in intersection

    mkdir /cluster/data/caePb1/bed/blastz.cb3.swap
    cd /cluster/data/caePb1/bed/blastz.cb3.swap
    time nice -n +19 doBlastzChainNet.pl -verbose=2 \
	/cluster/data/cb3/bed/blastz.caePb1.2007-04-18/DEF \
	-qRepeats=windowmaskerSdust -bigClusterHub=kk \
	-swap > swap.log 2>&1 &
    #	real    3m57.854s
    cat fb.caeRem2.chainCb3Link.txt
    #	59366018 bases of 175247318 (33.876%) in intersection

##############################################################################
## Repeat masker with -species "caenorhabditis sp. 4 (ce-ii)"
##	(DONE - 2007-04-19 - Hiram)

    ssh kkstore01
    mkdir /cluster/data/caePb1/bed/RepeatMasker
    cd /cluster/data/caePb1/bed/RepeatMasker
    time nice -n +19 doRepeatMasker.pl -species "caenorhabditis sp. 4 (ce-ii)"

    time nice -n +19 doRepeatMasker.pl -species "caenorhabditis" \
	-bigClusterHub=kk \
	-buildDir=/cluster/data/caePb1/bed/RepeatMasker caePb1 > do.log 2>&1 &
    #	real    118m40.879s

    cd /cluster/data/caePb1
    twoBitToFa caePb1.rmsk.2bit stdout | faSize stdin
    #	207333000 bases (32085682 N's 175247318 real
    #	169630672 upper 5616646 lower) in 1 sequences in 1 files
    #	%2.71 masked total, %3.20 masked real

    ssh hgwdev
    featureBits caePb1 rmsk
    #	5618476 bases of 175247318 (3.206%) in intersection

##############################################################################
## BLASTZ swap ce4 (DONE - 2007-03-04 -- Hiram
    ssh kkstore01
    cd  /cluster/data/ce4/bed/blastz.caePb1.um.2007-03-04
    cat fb.ce4.chainCaePb1Link.txt
    #	52594760 bases of 100281244 (52.447%) in intersection

    mkdir /cluster/data/caePb1/bed/blastz.ce4.swap
    cd /cluster/data/caePb1/bed/blastz.ce4.swap
    time nice -n +19 doBlastzChainNet.pl -verbose=2 \
	-qRepeats=windowmaskerSdust \
	/cluster/data/ce4/bed/blastz.caePb1.um.2007-03-04/DEF \
	-bigClusterHub=pk -swap > swap.log 2>&1 &
    #	real    22m40.205s
    cat fb.caePb1.chainCe4Link.txt
    #	74758640 bases of 175247318 (42.659%) in intersection

##############################################################################
## BLASTZ caeRem2 (WORKING - 2007-04-19 - Hiram)
    ssh kkstore01
    mkdir /cluster/data/caePb1/bed/blastz.caeRem2.2007-04-19
    cd /cluster/data/caePb1/bed/blastz.caeRem2.2007-04-19

    cat << '_EOF_' > DEF
# caePb1 vs caeRem2
BLASTZ_H=2000
BLASTZ_M=50

# TARGET: C. PB2801 caePb1 unmasked sequence
SEQ1_DIR=/san/sanvol1/scratch/worms/caePb1/caePb1.unmasked.2bit
SEQ1_LEN=/san/sanvol1/scratch/worms/caePb1/chrom.sizes
SEQ1_CHUNK=1000000
SEQ1_LAP=10000
SEQ1_LIMIT=50

# QUERY: briggsae caeRem2, 9,660 contigs, longest 5,925,111
SEQ2_DIR=/san/sanvol1/scratch/worms/caeRem2/caeRem2.2bit
SEQ2_LEN=/san/sanvol1/scratch/worms/caeRem2/chrom.sizes
SEQ2_CTGDIR=/san/sanvol1/scratch/worms/caeRem2/caeRem2.contigs.2bit
SEQ2_CTGLEN=/san/sanvol1/scratch/worms/caeRem2/caeRem2.contigs.sizes
SEQ2_LIFT=/san/sanvol1/scratch/worms/caeRem2/caeRem2.chrUn.lift
SEQ2_CHUNK=1000000
SEQ2_LAP=10000
SEQ2_LIMIT=50

BASE=/cluster/data/caePb1/bed/blastz.caeRem2.2007-04-19
TMPDIR=/scratch/tmp
'_EOF_'
    # << happy emacs

    time nice -n +19 doBlastzChainNet.pl DEF -verbose=2 -bigClusterHub=kk \
	-blastzOutRoot /cluster/bluearc/caePb1CaeRem2 > do.log 2>&1 &
    cat fb.caePb1.chainCaeRem2Link.txt
    #	93139445 bases of 175247318 (53.147%) in intersection

    #	swap to caeRem2  (also in caeRem2.txt)
    mkdir /cluster/data/caeRem2/bed/blastz.caePb1.swap
    cd /cluster/data/caeRem2/bed/blastz.caePb1.swap
    time nice -n +19 doBlastzChainNet.pl -verbose=2 \
	/cluster/data/caePb1/bed/blastz.caeRem2.2007-04-19/DEF \
	-bigClusterHub=kk -swap > swap.log 2>&1 &
    #	real    32m51.630s
    cat 

##############################################################################
## BLASTZ priPac1 (WORKING - 2007-04-20 - Hiram)
    mkdir /cluster/data/caePb1/bed/blastz.priPac1.2007-04-20
    cd /cluster/data/caePb1/bed/blastz.priPac1.2007-04-20

    cat << '_EOF_' > DEF
# caePb1 vs priPac1
BLASTZ_H=2000
BLASTZ_M=50

# TARGET: C. PB2801 caePb1 unmasked sequence
SEQ1_DIR=/san/sanvol1/scratch/worms/caePb1/caePb1.unmasked.2bit
SEQ1_LEN=/san/sanvol1/scratch/worms/caePb1/chrom.sizes
SEQ1_CHUNK=1000000
SEQ1_LAP=10000
SEQ1_LIMIT=50

# QUERY: Pristionchus pacificus priPac1
SEQ2_DIR=/san/sanvol1/scratch/worms/priPac1/priPac1.unmasked.2bit
SEQ2_LEN=/san/sanvol1/scratch/worms/priPac1/chrom.sizes
SEQ2_CHUNK=1000000
SEQ2_LAP=10000
SEQ2_LIMIT=50

BASE=/cluster/data/caePb1/bed/blastz.priPac1.2007-04-20
TMPDIR=/scratch/tmp
'_EOF_'

    time nice -n +19 doBlastzChainNet.pl DEF -verbose=2 -bigClusterHub=pk \
	-blastzOutRoot /cluster/bluearc/caePb1PriPac1 > do.log 2>&1 &
    cat fb.caePb1.chainPriPac1Link.txt
    #	13589188 bases of 175247318 (7.754%) in intersection

    ## swap to priPac1 - also in priPac1.txt
    mkdir /cluster/data/priPac1/bed/blastz.caePb1.swap
    cd /cluster/data/priPac1/bed/blastz.caePb1.swap
    time nice -n +19 doBlastzChainNet.pl -verbose=2 -bigClusterHub=pk \
	/cluster/data/caePb1/bed/blastz.priPac1.2007-04-20/DEF \
	-swap > swap.log 2>&1 &
    #	real    9m18.554s
    cat fb.priPac1.chainCaePb1Link.txt
    #	11713567 bases of 145948246 (8.026%) in intersection
