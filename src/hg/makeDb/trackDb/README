This directory contains the track database for
the UCSC human genome browser.  The program
hgTrackDb converts the information here into
a 'trackDb' table in the hgN MySQL database.

SEE ALSO: source tree file: src/product/README.trackDb
	for a general discussion of developing tracks.

The bulk of the information about a track is
contained in the trackDb.ra file.  Tracks are
separated from each other in this file by 
a blank line.  Each line begins with an
attribute name and is followed by attribute
value separated by white space.

The html text about a track is in separate
files named xxx.html where xxx is a
track name.   

There may be subdirectories for each organism such
as 'mouse', and underneath these directories for
each database, such as 'hg7'.  There are a trackDb.ra 
file and xxx.html files in these subdirectories.
Tracks descriptions in the subdirectory will
over-ride track descriptions in the parent directory.
This allows you to customize a track for
each version of the database.

After editing a track definition here
hgTrackDb to bring it into the MySQL database.  To update
your personal copy (on hgwdev-userName) do
    make update
to do it on genome-test do
    make alpha
You can also restrict a track to alpha or beta using
by using the release field.

THE TYPE FIELD

One of the most important and complicated fields in the
trackDb.ra file is the type field.  Here's an explanation
of that field.  Explanations of several other less-than-obvious
fields follow.

Currently there are fourteen different track types:
axt, bed, chain, clonePos, ctgPos, expRatio, genePred,
maf, netAlign, psl, rmsk, sample, wigMaf and wig

	(notation: <angle brackets> indicate required field,
		[square brackets] indicate optional field)

The format of the type fields:

1. type axt <otherDb>
   <otherDb> - other database this organism is aligned to
2. type bed <fieldCount> <extraInfo>
   <fieldCount> - the number of standard fields
   <extraInfo> - either '.' meaning no non-standard fields
       or '+' if there are additional non-standard fields.
3. type chain <otherDb>
   Alignment data
   <otherDb> - other database this organism is aligned to
4. type clonePos
   unique for Clone Coverage track on human assemblies
5. type ctgPos
   unique for Physical Map Contigs track on human assemblies
6. type expRatio
    DNA chip expression data
    Nothing follows expRatio, but the following fields
    must be defined elsewhere in the trackDb.ra record:
       expTable - table in hgFixed with names of experiments etc.
       expScale - maximum expression value
       expStep - amount to step in visible expression scale.  Some
           round number close to expScale/8 is best
       expColorDense On - show avg. color in dense mode
       chip - Name of microarray chip.
7. type genePred [pep_table] [mrna_table]
   Gene prediction data, use '.' when a positional parameter must be skipped
   [pep_table] - optional associated protein sequence table
   [mrna_table] - optional associated representative mRNA table
   [autoTranslate] - if set to 0 then translated protein won't be generated
      in the details page.
   Optional fields to be defined elsewhere in the trackDb.ra record:
	itemAttrTbl - table used to color individual items in a track, 
                      selected by name and locations.
                     
8. type maf 
    A type of multiple alignment track, becoming obsolete, 
        to be replaced by wigMaf 
9. type netAlign <otherDb> <otherDbChainTable>
   <otherDb>
   <otherDbChainTable>
   Also requires an otherDb field to be defined in the trackDb.ra record
10. type psl <subtype> [otherDb]
   <subtype> - one of: est, mrna, protein, xeno or .
      Where . means regular human mRNA
   [otherDb] - optional xeno subtype, database associated
      with other organism.  If present the display can be colored by
      chromosome and the chromosome and position in kilobases is shown
      as the item label.
   Optional variable here, for psl tracks that also have sequence loaded.
   The presence of this option in the trackDb entry enables its function.
   pslSequence no		# allows user to select the other two
   pslSequence all		# show nucleotide labels on all bases
   pslSequence different	# show nucleotide labes only on different bases
11. type rmsk
   Unique type for Repeat Masker tracks
12. type sample [min] [max]
   A continuous value graphing type of track.
   Becoming obsolete, replaced by the 'type wig' tracks.
   [min] - optional minimum limit of data, default 0.  Used just for label.
   [max] - optional maximum limit of data, default 1000. Used just for label.
13. type wigMaf <minVal> <maxVal>
   A composite type of track to graph multiple and pairwise alignments.
   track name is table name of the multiple alignment maf table,
        with associated maf file in /gbdb (loaded with hgLoadMaf)
   type line includes data value range for conservation wiggle,
         as for wig track 
   standard wig track settings may be included (e.g. 
        maxHeightPixels, yLineOnOff, autoScaleDefault).  These
        apply to both conservation and pairwise wiggles
   Settings in the trackDb.ra record:
      wiggle - contains table names of conservation wiggles
                          (loaded with hgLoadWiggle)
        in the format "wiggle <table1> <label1>... <tableN> <labelN>"
           where the first table is the default, and the labels are displayed
           in the left label area of the conservation wiggle.  If only
           one table is listed, and no label is present, the default
           label "Conservation" will be displayed.
      speciesOrder - specifies the order of each pairwise items in the display
        Each species is specified as in the MAF file
        Organism names with embedded dots and/or spaces,
        these are stripped and replaced with underscore.
        E.g. (C. elegans -> c_elegans).
      speciesGroup - list of "clades" to group the species
        This option is an alternative to speciesOrder, used when
        there are many species.  Each speciesGroup in the list must have it's
        own setting (sGroup_<group>), followed by a list of species,
        specified as for speciesOrder.
      speciesTree - the phylogenetic tree for the species represented
        in the maf. This will be used for the "show shortest path" display
	mode if "speciesTarget" is defined. 
      speciesTarget - the default species target for the "show shortest path"
        mode of maf display. If this setting is present, then the default 
	maf display is "show shortest path".
      treeImage - path from web server htdocs dir (normally /images)
            to a file containing a picture of the phylogenetic tree for
            this track
      pairwise - contains suffix of the pairwise maf tables.
            The prefix is generated from the species name, as specified above.
            An underscore is used to separate (e.g. chimp_hmrg if
            setting is "hmrg").  If there is a wig table named
            <species>_<suffix>_wig, this is used for pairwise display.
            In this case, the wiggle height for the pairwise can
            be specified as the last word on this line.
            (e.g. pairwise CFTR 20, will have 20 pixel height of
            pairwise wiggle from tables named <species>_CFTR_wig).
      summary - contains table name of maf summary table (used as 
            replacement for "pairwise" tables, above.  A summary
            table is created from a multiple alignment maf file
            using the utility hgLoadMafSummary.
      speciesDefaultOff - contains a list of species that are
            not displayed in the track display unless explicitly
            configured in from the track config page.
14. type wig [lower] [upper]
   Continuous value graphing track.
   [lower] - overall lower limit of the data, default 0.0
   [upper] - overall upper limit of the data, default 127.0
   trackDb record options:
      autoScale         on|off               # default is off
      gridDefault       on|off               # default is off (draw y=0.0 line)
      maxHeightPixels   max:default:min      # default is 128:128:11
      graphType         bar|points           # default is bar
      viewLimits        lower:upper    # default is from the type line limits
      yLineMark         real-value     # default is 0.0
      yLineOnOff        on|off         # default is off (draw y=yLineMark line)
      windowingFunction maximum|mean|minimum # default is maximum
      smoothingWindow   off|[2-16]           # default is off
15. type bedGraph [column]
   Same type of graphing function as #14 above 'type wig'
   In this case, the data table is a bed type of table loaded
   with hgLoadBed.  The [column] specified is a numeric column of data
   in the table to be used for the graphing value.  The default column
   to graph would be column five, the 'score'.  All graphing options as
   described above in 'type wig' apply to this type of track.
   Two extra options are used here to specify maximum graphing bounds:
      minLimit <value>   # default is 0
      maxLimit <value>   # default is 1000
    
If something lacks a type field it needs to have custom
display routines.   You can remove a track from the
browser by removing it from the .ra file and doing
a make update.

OTHER FIELDS

The shortLabel and longLabel fields may have the following
variables, which will be substituted:
     $ORGANISM - all upper case organism, like 'MOUSE'
     $Organism - initial capped organism, like 'Mouse'
     $organism - all lower case organism, like 'mouse'
     $db - database (like mm3, hg15, etc.)
     $date - freeze date of underlying assembly
     $blurb - If there is a blurb field in the .ra file this echos it.
In addition if there is a $otherDb field set in the .ra file these
variables are available
     $o_ORGANISM - all upper case other organism, like 'MOUSE'
     $o_Organism - initial capped other organism, like 'Mouse'
     $o_organism - all lower case other organism, like 'mouse'
     $o_db - other database (like mm3, hg15, etc.)
     $o_date - freeze date of underlying other assembly

If there is a colorChromDefault field (values "on" or "off"), it
is used to set the default value for chromosome coloring
in affected tracks (type psl xeno <db>).  Without the field,
the default is "on".

All ra fields that are not explictly handled in trackDbCustom.c:trackDbAddInfo 
are added to the trackDb->settingsHash table.

Some settings used by various tracks:
    o exonArrows - if specified to draw strand arrows on exons.
    o itemAttrTbl - table used to color individual items in a track, selected
      by name and locations.  Currently works for genePred tracks.
url http://www.ncbi.nih.gov/IEB/Research/Acembly/av.cgi?db=human&l=$$
    o url - If present puts up a link to an external URL on the details
      page.  The url includes everything else on the line after the first word.
      The string $$ will be replaced by the name of an item.   Example:
      url http://www.ncbi.nlm.nih.gov/htbin-post/Entrez/query?form=4&db=n&term=$$
    o maxItems - Maximum number of items to be displayed individually in full
      mode.  If there are more items than this they will be drawn on top of
      each other on the last line.  In packed mode this refers to the number
      of lines rather than number of items.
    o directUrl - If present this will replace the "hgc" details page with 
      whats in the url.  The URL is formatted as a printf line including
      the following fields in this order:
         %s - item name
	 %s - chromosome name
	 %d - chromosome start position
	 %d - chromosome end position
	 %s - track name
	 %s - database name
      An example is:
	directUrl /cgi-bin/hgGene?hgg_gene=%s&hgg_chrom=%s&hgg_start=%d&hgg_end=%d&hgg_type=%s&db=%s
      Note that it is possible to only include the first field or first few
      fields.  The fields must be in the given order if present though.
    o hgsid - if present the hgsid=XXXXXX CGI variable will be appended to the end
      of the directUrl string.

Note: We have a restriction on table names.   We currently do not handle
table names in the format chrN_table_name.   The 2nd underscore is not allowed.


COMPOSITE TRACKS
================
Tracks of the same type can be grouped in a single "composite track",
using the "compositeTrack on" setting.  The track name for the
composite track is a placeholder, that is referenced in entries for the
subtracks.  The subtracks have a "subTrack" setting that references
the composite track name.  The composite track entry contains all
normal settings for the track type.  

The subtrack track entries need contain only the short and long labels, 
they may optionally have a color setting and a priority within the 
composite track.  

If the subtracks lack color settings, and if color is set on the composite
track, the subtracks will be displayed with different colors in
a gradient from color to altColor.

To hide a subtrack initially, append "off" to the end of the
subtrack setting.

To include a subtrack of a different type, specify
the complete settings for the subtrack type, and use the "noInherit on"
trackDb setting.  This has not been entirely generalized -- use with care.

For readability, please indent the subtrack entries in trackDb.ra by 4 spaces.


Example:
---------------------
track encodeDnaRep
compositeTrack on
shortLabel DNA Rep
longLabel University of Virginia DNA Replication for ENCODE
group encode
priority 50.1
color 10,130,10 
altColor 50,50,50
visibility hide
type bed 3

    track encodeDnaRep0
    subTrack encodeDnaRep
    shortLabel 0-2hr
    longLabel Univ. Virginia Temporal Profiling of DNA Replication (0-2 hrs) in ENCODE Regions
    priority 1

    track encodeDnaRep2
    subTrack encodeDnaRep off
    shortLabel 2-4hr
    longLabel Univ. Virginia Temporal Profiling of DNA Replication (0-2 hrs) in ENCODE Regions
    priority 2

    track encodeDnaRep3
    subTrack encodeDnaRep
    shortLabel 2-4hr
    priority 3
    ---------------------

