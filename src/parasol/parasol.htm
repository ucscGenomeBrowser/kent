<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./parasol_files/filelist.xml">
<link rel=Edit-Time-Data href="./parasol_files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>Parasol Docs</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Jim Kent</o:Author>
  <o:Template>Outline.dot</o:Template>
  <o:LastAuthor>Donna Karolchik</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>2</o:TotalTime>
  <o:LastPrinted>2002-03-08T19:41:00Z</o:LastPrinted>
  <o:Created>2003-01-06T19:08:00Z</o:Created>
  <o:LastSaved>2003-01-06T19:08:00Z</o:LastSaved>
  <o:Pages>9</o:Pages>
  <o:Words>4031</o:Words>
  <o:Characters>22979</o:Characters>
  <o:Company> </o:Company>
  <o:Bytes>13312</o:Bytes>
  <o:Lines>191</o:Lines>
  <o:Paragraphs>45</o:Paragraphs>
  <o:CharactersWithSpaces>28219</o:CharactersWithSpaces>
  <o:Version>9.4402</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>0</w:DisplayVerticalDrawingGridEvery>
  <w:UseMarginsForDrawingGridOrigin/>
  <w:Compatibility>
   <w:UsePrinterMetrics/>
   <w:WW6BorderRules/>
   <w:FootnoteLayoutLikeWW8/>
   <w:ShapeLayoutLikeWW8/>
   <w:AlignTablesRowByRow/>
   <w:ForgetLastTabAlignment/>
   <w:LayoutRawTableWidth/>
   <w:LayoutTableRowsApart/>
  </w:Compatibility>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:Helvetica;
	panose-1:2 11 6 4 2 2 2 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Courier;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:3 0 0 0 1 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
h1
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:22.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-font-kerning:14.0pt;
	mso-bidi-font-weight:normal;}
h2
	{mso-style-parent:"Heading 1";
	mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:18.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-font-kerning:14.0pt;
	mso-bidi-font-weight:normal;}
h3
	{mso-style-parent:"Heading 2";
	mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:14.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-font-kerning:14.0pt;
	mso-bidi-font-weight:normal;}
h4
	{mso-style-parent:"Heading 3";
	mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:4;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-font-kerning:14.0pt;
	mso-bidi-font-weight:normal;}
h5
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:5;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	font-weight:normal;}
p.MsoNormalIndent, li.MsoNormalIndent, div.MsoNormalIndent
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoCommentText, li.MsoCommentText, div.MsoCommentText
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:center 3.0in right 6.0in;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:center 3.0in right 6.0in;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
span.MsoCommentReference
	{mso-ansi-font-size:8.0pt;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	text-align:center;
	mso-pagination:widow-orphan;
	font-size:16.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	mso-font-kerning:14.0pt;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
strong
	{mso-bidi-font-weight:normal;}
p.BodyTextWithTab, li.BodyTextWithTab, div.BodyTextWithTab
	{mso-style-name:BodyTextWithTab;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	text-indent:.3in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.Listing, li.Listing, div.Listing
	{mso-style-name:Listing;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:Courier;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
p.Note, li.Note, div.Note
	{mso-style-name:Note;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.25in;
	margin-bottom:.0001pt;
	text-indent:-.25in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;
	mso-bidi-font-weight:normal;
	font-style:italic;
	mso-bidi-font-style:normal;}
p.SecondaryHeading, li.SecondaryHeading, div.SecondaryHeading
	{mso-style-name:"Secondary Heading";
	mso-style-parent:"Heading 1";
	mso-style-next:Normal;
	margin-top:3.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.1in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	tab-stops:4.5in;
	font-size:22.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Helvetica;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.Coding, li.Coding, div.Coding
	{mso-style-name:Coding;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.2in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
@list l0
	{mso-list-id:-129;
	mso-list-type:simple;
	mso-list-template-ids:1007728432;}
@list l0:level1
	{mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1
	{mso-list-id:415591775;
	mso-list-type:simple;
	mso-list-template-ids:67698689;}
@list l1:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l2
	{mso-list-id:873545369;
	mso-list-type:simple;
	mso-list-template-ids:2044488982;}
@list l2:level1
	{mso-level-start-at:0;
	mso-level-number-format:bullet;
	mso-level-text:-;
	mso-level-tab-stop:1.45in;
	mso-level-number-position:left;
	margin-left:1.45in;
	text-indent:-.25in;
	font-family:"Times New Roman";}
@list l3
	{mso-list-id:1253322325;
	mso-list-type:simple;
	mso-list-template-ids:67698689;}
@list l3:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l4
	{mso-list-id:1557204136;
	mso-list-type:simple;
	mso-list-template-ids:67698689;}
@list l4:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l5
	{mso-list-id:2054192882;
	mso-list-type:simple;
	mso-list-template-ids:67698689;}
@list l5:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;
	font-family:Symbol;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
</head>

<body lang=EN-US link=blue vlink=purple style='tab-interval:.5in'>

<div class=Section1>

<h1>THE PARASOL PARALLEL BATCH SYSTEM</h1>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h2>OVERVIEW</h2>

<p class=MsoNormal>Parasol provides a convenient way for multiple users to run
large batches of jobs on computer clusters of up to thousands of CPUs.<span
style="mso-spacerun: yes">  </span>Parasol was developed initially by Jim Kent,
and extended by other members of the Genome Bioinformatics Group at the
University of California Santa Cruz.<span style="mso-spacerun: yes"> 
</span>Parasol is currently a fairly minimal system, but what it does it does
well.<span style="mso-spacerun: yes">   </span>It can start up 500 jobs per
second.<span style="mso-spacerun: yes">   </span>It restarts jobs in response
to the inevitable systems failures that occur on large clusters.<span
style="mso-spacerun: yes">  </span>If some of your jobs die because of your
program bugs, Parasol can help manage restarting the crashed jobs after you fix
your program as well.<span style="mso-spacerun: yes">  </span>The parasol
source is at <a href="http://www.soe.ucsc.edu/~kent/src/parasol.tgz">http://www.soe.ucsc.edu/~kent/src/parasol.tgz</a>.</p>

<h2>PARASOL QUICK START</h2>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>To start things rolling you need to make a directory to put
the batch in, and create a job list in this directory.<span
style="mso-spacerun: yes">  </span>A basic job list is just a series of command
lines, one for each job.<span style="mso-spacerun: yes">  </span>A fancier job
list can contain checks on the input and output files for each job.<span
style="mso-spacerun: yes">  </span>While generally jobs in a batch are somehow
related,<span style="mso-spacerun: yes">  </span>they need not be.<span
style="mso-spacerun: yes">   </span>Here’s a sample job list that compiles some
code in parallel.<span style="mso-spacerun: yes">  </span>:</p>

<p class=Coding><span style="mso-spacerun: yes">  </span>cc –c lions.c</p>

<p class=Coding><span style="mso-spacerun: yes">  </span><span lang=ES
style='mso-ansi-language:ES'>cc –c tigers.c<o:p></o:p></span></p>

<p class=Coding><span lang=ES style='mso-ansi-language:ES'><span
style="mso-spacerun: yes">  </span></span>cc –c bears.c</p>

<p class=Coding><span style="mso-spacerun: yes">  </span>cc –c turkeys.c</p>

<p class=Coding><span style="mso-spacerun: yes">  </span>cc –c bats.c</p>

<p class=MsoNormal>To run this on parasol you’d log onto the machine running
the parasol server and</p>

<p class=Coding><span style="mso-spacerun: yes">  </span>mkdir
compileTheAnimals</p>

<p class=Coding><span style="mso-spacerun: yes">  </span>cd compileTheAnimals</p>

<p class=Coding><span style="mso-spacerun: yes">  </span>para make ../job.lst</p>

<p class=MsoNormal>assuming you’d already created job.lst .<span
style="mso-spacerun: yes">   </span>The para program will hang out periodically
printing a little information until all the jobs are done or one of them fails
repeatedly.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>If your job has problems you can retrieve them with</p>

<p class=Coding><span style="mso-spacerun: yes">  </span>para problems</p>

<p class=MsoNormal>This will among other things copy over the standard error
output from the cluster nodes.<span style="mso-spacerun: yes">  </span>You may
need to put the parasol host in your .rhosts file for this to work.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h2>RUNNING A BIG BATCH OF JOBS WITH PARASOL</h2>

<p class=MsoNormal>Parasol is really meant for large batches of jobs.<span
style="mso-spacerun: yes">   </span>One big set of jobs we do at the Genome
group is comparing the mouse vs. the human genomes.<span style="mso-spacerun:
yes">  </span>Since humans and mice have a common ancestor, there are stretches
of DNA that are similar (homologous) between the two species.<span
style="mso-spacerun: yes">  </span>However since this common ancestor was
almost 100 million years ago most of the DNA has changed quite a bit.<span
style="mso-spacerun: yes">  </span>It’s not possible to find homologous regions
with a simple string search.<span style="mso-spacerun: yes">  </span>Instead
sophisticated “alignment” techniques must be used.<span style="mso-spacerun:
yes">   </span>Aligning whole genomes against each other is one of the most
compute intensive areas in bioinformatics.<span style="mso-spacerun: yes">  
</span>Fortunately it is a problem that can be easily distributed across many
machines.<span style="mso-spacerun: yes">  </span>We can break the human genome
into approximately 200 pieces, and the mouse genome into approximately 1000
pieces.<span style="mso-spacerun: yes">  </span>We then align each piece of the
human against each piece of the mouse.<span style="mso-spacerun: yes"> 
</span>This lets us split divide the big job into 200,000 little jobs.<span
style="mso-spacerun: yes">  </span>Each of these little jobs might take about
10 minutes on one computer.<span style="mso-spacerun: yes">  </span>On 1000
computers the whole set of jobs should take less than two days.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Since parasol wants a line of input for each job, clearly we
need an automatic way of generating the job list.<span style="mso-spacerun:
yes">  </span>This is where the program “gensub2” comes in.<span
style="mso-spacerun: yes">   </span>Gensub2 takes as input two lists of files
and a template file.<span style="mso-spacerun: yes">   </span>The template file
contains three parts – a preamble (everything before the #LOOP line) which is
literally copied to the output,<span style="mso-spacerun: yes">  </span>a
middle section which is repeated in the output with the filenames from the
lists substituted in,<span style="mso-spacerun: yes">  </span>and a postscript
(everything after the #ENDLOOP line) that is copied literally to the
output.<span style="mso-spacerun: yes">   </span>We’ve used gensub2 with a
number of schedulers – Condor and Codine as well as Parasol – and it has proven
a simple but effective tool.<span style="mso-spacerun: yes">   </span>Here is a
gensub2 template file for creating mouse/human alignments with the BLAT
program:</p>

<p class=Coding><span style="mso-spacerun: yes">  </span>#LOOP</p>

<p class=Coding><span style="mso-spacerun: yes">  </span>/cluster/bin/blat
$(path1) $(path2) out/$(root1)_$(root2) </p>

<p class=Coding><span style="mso-spacerun: yes">  </span>#ENDLOOP</p>

<p class=MsoNormal>Note depending on how parasol was set up on your system you
may need to include the full path name for executables.<span
style="mso-spacerun: yes">  </span>To create a job list do the following steps:</p>

<p class=Coding><span style="mso-spacerun: yes">  </span>mkdir mouseVsHuman</p>

<p class=Coding><span style="mso-spacerun: yes">  </span>cd mouseVsHuman</p>

<p class=Coding><span style="mso-spacerun: yes">  </span>mkdir out</p>

<p class=Coding><span style="mso-spacerun: yes">  </span>ls –1
/data/human/dna/pieces/*.seq &gt; human.lst</p>

<p class=Coding><span style="mso-spacerun: yes">  </span>ls –1
/data/mouse/dna/pieces/*.seq &gt; mouse.lst</p>

<p class=Coding><span style="mso-spacerun: yes">  </span>gensub2 human.lst
mouse.lst template jobList</p>

<p class=MsoNormal>You could at this point run “para make” on jobList.<span
style="mso-spacerun: yes">   </span>In the end if nothing went wrong you’d have
a directory ‘out’ full of files that look something like mouse001_human001,
mouse001_human002,<span style="mso-spacerun: yes">  </span>…. However this is a
big enough job that it’s very likely something will go wrong.<span
style="mso-spacerun: yes">    </span>It would be good to do a little sanity
check on the output.</p>

<p class=MsoNormal>It wouldn’t be a bad idea to write a program to double-check
the output yourself.<span style="mso-spacerun: yes">  </span>However Parasol
can do some basic checks automatically.<span style="mso-spacerun: yes"> 
</span>If we change our template file to read:</p>

<p class=Coding style='margin-left:0in'><span style='font-size:10.0pt'><span
style="mso-spacerun: yes"> </span></span><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt'>#LOOP<o:p></o:p></span></p>

<p class=Coding style='margin-left:0in'><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt'><span style="mso-spacerun:
yes"> </span>/cluster/bin/blat $(path1) $(path2) {check out line+
out/(root1)_$(root2)} <o:p></o:p></span></p>

<p class=Coding style='margin-left:0in'><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt'><span style="mso-spacerun: yes"> </span>#ENDLOOP<o:p></o:p></span></p>

<p class=MsoNormal>then Parasol will check that each file has at least one
line, and that the last line is complete.<span style="mso-spacerun: yes">  
</span>This won’t catch every problem, but it will catch the vast majority of
them.<span style="mso-spacerun: yes">  </span>Parasol will also of course
detect program crashes.<span style="mso-spacerun: yes">  </span>It’s possible
to put checks on input files as well.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Since this is a job liable to take more than a day,<span
style="mso-spacerun: yes">  </span>rather than running ‘para make’,<span
style="mso-spacerun: yes">  </span>I like to take a more interactive approach
as follows:</p>

<p class=Coding><span style="mso-spacerun: yes">  </span>para create
jobList<span style="mso-spacerun: yes">   </span># Create job tracking database</p>

<p class=Coding><span style="mso-spacerun: yes">  </span>para try<span
style="mso-spacerun: yes">              </span># Run ten jobs</p>

<p class=Coding><span style="mso-spacerun: yes">  </span>para check<span
style="mso-spacerun: yes">            </span># Check up on jobs</p>

<p class=Coding><span style="mso-spacerun: yes">  </span>para push<span
style="mso-spacerun: yes">             </span># Push up to 100,000 jobs</p>

<p class=Coding><span style="mso-spacerun: yes">  </span>para check<span
style="mso-spacerun: yes">            </span># Check up on jobs</p>

<p class=Coding><span style="mso-spacerun: yes">  </span>para push<span
style="mso-spacerun: yes">             </span># Retry any crashed jobs so far</p>

<p class=Coding><span style="mso-spacerun: yes">  </span>para time<span
style="mso-spacerun: yes">             </span># Collect timing information.</p>

<p class=MsoNormal>It’s always good to do a ‘try’ before a ‘push’,<span
style="mso-spacerun: yes">  </span>letting the first ten jobs run for five
minutes or so and then checking up on them.<span style="mso-spacerun: yes">  
</span>Note that “para push” will only resubmit jobs that have <b
style='mso-bidi-font-weight:normal'>already</b> crashed when para push is
run.<span style="mso-spacerun: yes">   </span>If you’re interactively
monitoring your jobs periodically pushing and checking (and timing) is
useful.<span style="mso-spacerun: yes">  </span>Once you decide things are
going well you can issue a “para shove” command, which will will check on your
jobs every few minutes, restarting jobs if necessary, until the jobs are all done
or one of the jobs has failed (crashed repeatedly).<span style="mso-spacerun:
yes">   </span>If you want to go back to interactive monitoring of your jobs
after a “para shove”, just hit &lt;control C&gt; to stop the shoving.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Typically there are three types of problems you encounter
with a big batch of jobs.<span style="mso-spacerun: yes">  </span>The most
common problem is a new bug in the program you’re running, which causes all or
most of your jobs to crash.<span style="mso-spacerun: yes">  </span>Doing a
“para try” will usually find these problems without wasting a lot of cluster
time.<span style="mso-spacerun: yes">  </span>Another common problem is when
one of the machines in the cluster is acting flaky for some reason – often
because it is having an i/o problem of some sort.<span style="mso-spacerun:
yes">   </span>When a “para check” shows that some jobs are crashing this is
the first thing to check.<span style="mso-spacerun: yes">  </span>Do a “para
problems” to get a report on the jobs that are having troubles, and see if they
are all on the same host.<span style="mso-spacerun: yes">  </span>If so tell
the system administrators about the problem.<span style="mso-spacerun: yes"> 
</span>They can use the “parasol remove machine” command to remove the machine
from parasol service until the problem can be fixed.<span style="mso-spacerun:
yes">  </span>The third common problem is due to rarely manifesting bugs in
your code.<span style="mso-spacerun: yes">  </span>The symptom of this is the
same job crashing repeatedly on different machines.<span style="mso-spacerun:
yes">  </span>There’s no cure for this except doing some debugging – usually
starting with isolating the minimum input needed to cause the problem.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h2>THE PARASOL ENVIRONMENT</h2>

<p class=MsoNormal>Parosol sets up a few environment variables prior to running
jobs.<span style="mso-spacerun: yes">  </span>The PARASOL variable is set to
the version of Parasol that is currently running.<span style="mso-spacerun:
yes">  </span>Programs can use this to determine whether they are running under
Parasol.<span style="mso-spacerun: yes">   </span>The JOB_ID variable is set to
a unique number for each job that is run.<span style="mso-spacerun: yes"> 
</span>How the PATH variable is set up depends on how Parasol was
installed.<span style="mso-spacerun: yes">   </span>At UCSC we have it set up
to run things out of the bin directory of each user as well as /bin, /usr/bin,
and /cluster/bin.<span style="mso-spacerun: yes">  </span>In general Parasol’s
PATH will be different from the path in your shell, so when in doubt include
the appropriate directory names in front of your executables.<span
style="mso-spacerun: yes">   </span>You can also depend on the USER, HOME, and
HOST variables being set to your user name, your home directory and the name of
the machine the program is running on.<span style="mso-spacerun: yes"> 
</span>Beyond this what is in the environment varies from installation to
installation.</p>

<h2>INSTALLING PARASOL</h2>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>To install parasol you’ll need to create a list of the
machines in your cluster, and then run the ‘paraNodeStart’ which will launch a
‘paraNode’ server on each machine.<span style="mso-spacerun: yes">  </span>Next
pick a machine, preferably one without much else going on in it to launch a
‘paraHub’ server.<span style="mso-spacerun: yes">  </span>Parasol users will
then log onto this machine to launch jobs either using the ‘para’ or the
‘parasol’ commands.<span style="mso-spacerun: yes">    </span>You can bring
down the paraNode servers with the ‘paraNodeStop’ command.<span
style="mso-spacerun: yes">  </span>You can bring down the paraHub with
‘paraHubStop’.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Here’s a list of the user programs in the Parasol package:</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l5 level1 lfo2;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>para – a user-level command which manages a single
batch of jobs</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l5 level1 lfo2;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>gensub2 – a user-level command for generating large
batches of<span style="mso-spacerun: yes">  </span>jobs, each on a different
set of files.</p>

<p class=MsoNormal>Here’s a list of the administrative programs:</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l5 level1 lfo2;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>parasol – administrative command for looking at all
active jobs in the system and adding or removing nodes on the fly. Users may
find this command handy too, though several aspects of it can only be accessed
by root.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l5 level1 lfo2;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>paraNode – runs jobs on a compute node</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l5 level1 lfo2;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>paraHub – job scheduler</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l5 level1 lfo2;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>paraNodeStart – start up paraNode daemons</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l5 level1 lfo2;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>paraNodeStop – bring down paraNode daemons</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l5 level1 lfo2;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>paraNodeStatus – query status of paraNode daemons</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l5 level1 lfo2;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>paraHubStop – bring down paraHub daemon</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>The first thing an administrator needs to do is create a
list of machines to use as compute nodes.<span style="mso-spacerun: yes"> 
</span>This list is a tab-separated file with one line for each machine and the
following fields:</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l3 level1 lfo4;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>&lt;host name&gt; - Network name of host.<span
style="mso-spacerun: yes">  </span></p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l3 level1 lfo4;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>&lt;number of cpus&gt; - Number of CPUs to use in the
machine</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l3 level1 lfo4;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>&lt;meg of memory&gt; - Megabytes of memory in machine</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l3 level1 lfo4;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>&lt;local temp dir&gt; - A directory in the machine for
temp files.<span style="mso-spacerun: yes">  </span>Parasol puts the standard
error output here.<span style="mso-spacerun: yes">  </span>Ideally this
directory should periodically have files not accessed for a week removed.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l3 level1 lfo4;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>&lt;local data dir&gt;<span style="mso-spacerun: yes"> 
</span>- A directory where local data resides.<span style="mso-spacerun: yes"> 
</span>Ignored for now.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l3 level1 lfo4;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>&lt;local data gig&gt; - Size of local data
directory.<span style="mso-spacerun: yes">  </span>Ignored for now.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l3 level1 lfo4;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>&lt;network switch&gt; - Name of network switch this is
on.<span style="mso-spacerun: yes">  </span>Ignored for now.</p>

<p class=MsoNormal><br>
Here is a small example:</p>

<p class=Coding><span style="mso-spacerun: yes">  </span>testBad.node.ucsc 2
1024 /tmp /scratch 36000 r1<br>
<span style="mso-spacerun: yes">  </span>kkr1u01.kilokluster.ucsc.edu 2 1024
/tmp /scratch 36000 r1<br>
<span style="mso-spacerun: yes">  </span>kkr1u02.kilokluster.ucsc.edu 2 1024
/tmp /scratch 36000 r1</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>To start up the Parasol system do the following:</p>

<p class=Coding><span style="mso-spacerun: yes">  </span><span lang=ES
style='mso-ansi-language:ES'>ssh parasolhost<o:p></o:p></span></p>

<p class=Coding><span lang=ES style='mso-ansi-language:ES'><span
style="mso-spacerun: yes">  </span>mkdir parasolRootDir<o:p></o:p></span></p>

<p class=Coding><span lang=ES style='mso-ansi-language:ES'><span
style="mso-spacerun: yes">  </span></span>cd parasolRootDir</p>

<p class=Coding><span style="mso-spacerun: yes">  </span>cp machineList .</p>

<p class=Coding><span style="mso-spacerun: yes">  </span>su root</p>

<p class=Coding><span style="mso-spacerun: yes">  </span>paraNodeStart
machineList hub=parasolHost </p>

<p class=Coding style='margin-left:.7in;text-indent:.3in'><span
style="mso-spacerun: yes"> </span>userPath=bin sysPath=/share/bin:/usr/local/bin
</p>

<p class=Coding style='margin-left:.7in;text-indent:.3in'><span
style="mso-spacerun: yes"> </span>log=/tmp/log</p>

<p class=Coding><span style="mso-spacerun: yes">  </span>paraHub machineList
–log=log &amp;</p>

<p class=MsoNormal>You may well want to customize the userPath and sysPath
according to the conventions used at your own installation.<span
style="mso-spacerun: yes">   </span>The hub log will create a log that averages
about 500 bytes per job, which can be useful for debugging.<span
style="mso-spacerun: yes">  </span>Omit the –log parameter for no log (not even
syslog).<span style="mso-spacerun: yes">  </span>For further security use the
–subnet parameter to paraHub which will restrict incoming messages to the hub
to a particular subnet.<span style="mso-spacerun: yes">   </span>A common
example of this would be</p>

<p class=Coding><span style="mso-spacerun: yes">  </span>paraHub machineList
–log=log –subnet=124.168 &amp;</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>The paraHub daemon will detect machines that are down and
work around them.<span style="mso-spacerun: yes">  </span>Every</p>

<p class=MsoNormal>ten minutes it will see if a machine that is down has come
back up.<span style="mso-spacerun: yes">   </span>It’s possible to add new
machines without bringing down the daemon using</p>

<p class=Coding><span style="mso-spacerun: yes">  </span>parasol add machine
tempDir</p>

<h2>ARCHITECTURE</h2>

<p class=MsoNormal>The Parasol system consists primarily of a scheduling server
and two clients: parasol and para.<span style="mso-spacerun: yes">  </span>The
parasol scheduling system consists of a hub daemon, a heartbeat daemon, and
number of spoke daemons running on the server system, and a node daemon running
on each compute node.<span style="mso-spacerun: yes">  </span>The parasol and
para clients both communicate only with the hub daemon.<span
style="mso-spacerun: yes">  </span>The parasol client is quite lightwieght
doing little more than forwarding messages from the command line to the parasol
hub and printing the replies.<span style="mso-spacerun: yes">  </span>The para
client is more substantial.<span style="mso-spacerun: yes">  </span>It creates
a database around a batch of jobs submitted by the user and tracks the progress
of these jobs through the scheduler.<span style="mso-spacerun: yes"> 
</span>Para does not expect the scheduler or the compute nodes to be completely
reliable, and will resubmit jobs as necessary.</p>

<h4><!--[if gte vml 1]><v:shapetype id="_x0000_t75" coordsize="21600,21600"
 o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe" filled="f"
 stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="_x0000_i1025" type="#_x0000_t75" style='width:366pt;
 height:480pt' fillcolor="window">
 <v:imagedata src="./parasol_files/image001.png" o:title="processes"/>
 <w:bordertop type="single" width="4"/>
 <w:borderleft type="single" width="4"/>
 <w:borderbottom type="single" width="4"/>
 <w:borderright type="single" width="4"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=490 height=642
src="./parasol_files/image002.gif" v:shapes="_x0000_i1025"><![endif]></h4>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'>Figure 1</b>.<span
style="mso-spacerun: yes">  </span>Parasol processes (circles) and message flow
(arrows).<span style="mso-spacerun: yes">  </span>All processes reside on the
scheduling machine except for the node processes.<span style="mso-spacerun:
yes">    </span>A spoke process can send messages to any node.<span
style="mso-spacerun: yes">  </span></p>

<h3>The Scheduling System</h3>

<h4>The Hub Daemon and Its Spokes and Pulse</h4>

<p class=MsoNormal>The hub daemon is the heart of the parasol scheduling
system. The hub daemon spawns the heartbeat daemon and the spoke deamons on
startup. The hub daemon then goes into a loop processing messages it recieves
on the hub TCP/IP socket.<span style="mso-spacerun: yes">  </span>The hub
daemon does not do anything time consuming in this loop.<span
style="mso-spacerun: yes">   </span>The main thing the hub daemon does is put
jobs on the job list,<span style="mso-spacerun: yes">  </span>move machines
from the busy list to the free list,<span style="mso-spacerun: yes"> 
</span>and call the 'runner' routine.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>The runner routine looks to see if there is a free machine,
a free spoke, and a job to run.<span style="mso-spacerun: yes">  </span>If so
it will send a message to the spoke telling it to run the job on the
machine,<span style="mso-spacerun: yes">  </span>and then move the job from the
'pending' to the 'running' list,<span style="mso-spacerun: yes">  </span>the
spoke from the freeSpoke to the busySpoke list, and the machine from the
freeMachine to the busyMachine list.<span style="mso-spacerun: yes">  
</span>This</p>

<p class=MsoNormal>indirection of starting jobs via a separate spoke process
avoids the hub daemon itself having to wait to find out if a machine is down.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>When a spoke is done assigning a job, the spoke sends a
'recycleSpoke' message to the hub, which puts the spoke back on the freeSpoke
list. Likewise when a job is done the machine running the jobs sends a 'job
done' message to the hub, which puts the machine back on the free list,<span
style="mso-spacerun: yes">  </span>writes the job exit code to a results file,
and removes the job</p>

<p class=MsoNormal>from the system.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Sometimes a spoke will find that a machine is down.<span
style="mso-spacerun: yes">  </span>In this case it sends a 'node down' message
to the hub as well as the 'spoke free' message.<span style="mso-spacerun:
yes">   </span>The hub will then move the machine to the deadMachines list, and
put the job back on the top of the pending list.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>The heartbeat daemon simply sits in a loop sending heartbeat
messages to the hub every so often (every 30 seconds currently), and sleeping
the rest of the time.<span style="mso-spacerun: yes">   </span>When the hub
gets a heartbeat message it does a few things:</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l1 level1 lfo5;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>It calls runner to try and start some more jobs.<span
style="mso-spacerun: yes">  </span>(Runner is also called at the end of
processing a recycleSpoke, jobDone, addJob or addMachine message.<span
style="mso-spacerun: yes">  </span>Typically runner won't find anything new to
run in the heartbeat, but this is put here mostly just in case of unforseen
issues.)</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l1 level1 lfo5;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>It calls a routine to see if machines on the dead list
have come back to life.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l1 level1 lfo5;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>It calls a routine to see if jobs the system thinks
have been running for a long time are still running on the machine they have
been assigned to. If the machine has gone down it is moved to the dead list and
the job is reassigned.<span style="mso-spacerun: yes">  </span>If the machine
is up it lets the hub know if it has already finished the job.<span
style="mso-spacerun: yes">  </span>This currently does happen, albeit in
perhaps 1 in 10,000 jobs due to failure for the jobDone message to get
through.<span style="mso-spacerun: yes">  </span>If the job is still running
the hub gets notified, and check back on the job five or ten minutes later.</p>

<p class=MsoNormal>This whole system depends on the hub daemon being able to
finish processing messages fast enough to keep the connection queue on the hub
socket from overflowing.<span style="mso-spacerun: yes">  </span>Each job
involves 3 messages to the hub socket:</p>

<p class=MsoNormal><span style="mso-spacerun: yes">    </span>addJob - from a
client to add the job to the system</p>

<p class=MsoNormal><span style="mso-spacerun: yes">    </span>recycleSpoke -
from the spoke after it's dispatched the job</p>

<p class=MsoNormal><span style="mso-spacerun: yes">    </span>jobDone - from
the compute node when the job is finished</p>

<p class=MsoNormal>On some of the earlier Linux kernals we had trouble with the
connection queue overflowing when dispatching lots of short jobs.<span
style="mso-spacerun: yes">  </span>This seemed to be from the jobDone messages
coming in faster than Linux could make connections rather than the</p>

<p class=MsoNormal>hub daemon being slow.<span style="mso-spacerun: yes"> 
</span>On the kilokluster with a more modern kernal this has been less of a
problem – only manifesting on 1,000 CPUs when running 50,000 jobs that do
nothing.<span style="mso-spacerun: yes">  </span>(The shorter the job the more
stressful it is on the scheduler).<span style="mso-spacerun: yes"> 
</span>Should overflow occur the heartbeat processing will gradually rescue the
system in any case, but the throughput will be greatly reduced.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>When the hub daemon first comes up it queries each node
daemon for running and recently finished jobs.<span style="mso-spacerun: yes"> 
</span>If the hub is brought down for maintenance or crashes due to a program
error,<span style="mso-spacerun: yes">  </span>CPU time already invested in
running jobs on nodes is usually recovered.<span style="mso-spacerun: yes"> 
</span>Currently jobs that have not yet been sent to nodes will be lost,<span
style="mso-spacerun: yes">  </span>though if they are submitted via the ‘para’
client below,<span style="mso-spacerun: yes">  </span>the para client will
resubmit these jobs after noting ‘tracking errors.’<span style="mso-spacerun:
yes">  </span>This feature of reconnecting to running jobs is new as of paraHub
version 2.<span style="mso-spacerun: yes">   </span></p>

<h4>The Node Daemon</h4>

<p class=MsoNormal>The node daemon is relatively simple.<span
style="mso-spacerun: yes">  </span>It forks off a process to run a job in
response to a “run” message over it’s TCP/IP socket from a spoke.<span
style="mso-spacerun: yes">  </span>It sends a “jobDone” message to the hub with
the return status code and user and system run times when a job finishes.<span
style="mso-spacerun: yes">  </span>It keeps a count of CPUs free, and refuses
to start a job unless a CPU is free.<span style="mso-spacerun: yes">  
</span>It also will kill a job in response to a “kill” message from the hub.<span
style="mso-spacerun: yes">  </span></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>The node daemon also participates in the heartbeat
processing.<span style="mso-spacerun: yes">   </span>It responds to a
“resurrect” message with an “alive” message in the process that leads to a
machine that was down being restored to use.<span style="mso-spacerun: yes"> 
</span>It responds to “check jobId” messages with a response saying whether or
not the job is running, finished or has never been seen.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>The node daemon needs to be run as root, so that it can
setuid to run jobs as any particular user.</p>

<h3>The Para Client </h3>

<p class=MsoNormal>The <span style='font-family:"Courier New";mso-bidi-font-family:
"Times New Roman"'>para</span> client manages batchs of jobs through the
scheduler. It is designed to catch jobs which may have run into problems of any
sort, and give the user a chance to rerun them after the problem is fixed.<span
style="mso-spacerun: yes">  </span>The major input to para is a job list.<span
style="mso-spacerun: yes">  </span>Each job can have checks associated with it
before and after the job itself is run.<span style="mso-spacerun: yes">  
</span>Initially para reads the job list and transforms it into a job database.<span
style="mso-spacerun: yes">  </span>The central routine of <span
style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>para</span>,
paraCycle, reads the job database,<span style="mso-spacerun: yes"> 
</span>queries the hub to see what jobs are running and waiting,<span
style="mso-spacerun: yes">  </span>looks at the results file to see what jobs
are finished,<span style="mso-spacerun: yes">  </span>performs output checks on
the finished jobs, sends unsubmitted jobs or jobs that need to be rerun to the
hub,<span style="mso-spacerun: yes">  </span>updates the database in memory,
and writes it back out.<span style="mso-spacerun: yes">  </span>The database is
in a comma-delimited text format with one job per line.<span
style="mso-spacerun: yes">  </span>The job database keeps track of the timing
and status of each job submission. The code to read and write this database was
generated with AutoSql.<span style="mso-spacerun: yes">   </span><span
style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>para</span>
will avoid loading the hub with more than 100,000 jobs at a time,<span
style="mso-spacerun: yes">  </span>and will only submit failed jobs three times
before giving up on them.<span style="mso-spacerun: yes">   </span></p>

<h2>PARASOL<span style="mso-spacerun: yes">  </span>COMMAND REFERENCE</h2>

<p class=MsoNormal>Note that all commands will produce a usage summary if run
with no arguments.<span style="mso-spacerun: yes">  </span>In general this
summary will be more up to date than the descriptions here.</p>

<h3>para</h3>

<p class=Coding><span style='font-size:10.0pt'>Manage a batch of jobs in
parallel on a compute cluster.<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>Normal usage is to do a 'para
create' followed by 'para push' until job is done.<span style="mso-spacerun:
yes">  </span>Use 'para check' to check status<o:p></o:p></span></p>

<h4>Command Line</h4>

<p class=Coding><span style='font-size:10.0pt'>usage:<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>para command [command-specific arguments]<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>The commands are:<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>para create jobList<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>This makes the job-tracking database from a text file with the<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>command line for each job on a separate line.<span
style="mso-spacerun: yes">  </span>See below for <o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>further description of the jobList.<span style="mso-spacerun:
yes">  </span>The ‘in’ checks in the<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>jobList will be performed at this time.<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>para push<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>This pushes forward the batch of jobs, submitting jobs to
parasol.<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>It will limit parasol queue size to something not too big and<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>retry failed jobs<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>options:<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">      </span>-retries=N<span style="mso-spacerun: yes">   </span>Number of
retries per job - default 4.<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">      </span>-maxQueue=N<span style="mso-spacerun: yes">  </span>Number of
jobs to allow on parasol queue<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">                   </span>-<span style="mso-spacerun: yes"> 
</span>default 200000<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">      </span>-minPush=N<span style="mso-spacerun: yes">  </span>Minimum
number of jobs to queue - default 1.<span style="mso-spacerun: yes">  </span><o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">                  </span>Overrides maxQueue<o:p></o:p></span></p>

<p class=Coding style='margin-left:0in'><span style='font-size:10.0pt'><span
style="mso-spacerun: yes">        </span>-maxPush=N<span style="mso-spacerun:
yes">  </span>Maximum number of jobs to queue - default 100000<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">      </span>-warnTime=N Number of minutes job runs before hang warning <o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">                  </span>- default 4320 (3 days)<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">      </span>-killTime=N Number of minutes job runs before push kills it <o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">                  </span>- default 20160 (2 weeks)<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>para try<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>This is like para push, but only submits up to 10 jobs<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>para shove<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>Push jobs in this database until all are done or one fails after
N<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>retries<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>para make jobList<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>Create database and run all jobs in it if possible.<span
style="mso-spacerun: yes">  </span>If one job<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>crashes repeatedly this will fail.<span style="mso-spacerun:
yes">  </span>Suitable for inclusion in <o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>makefiles.<span style="mso-spacerun: yes">  </span>Same as a
'create' followed by a 'shove'.<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>para check<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>This checks on the progress of the jobs.<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>para stop<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>This stops all the jobs in the batch<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>para chill<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>Tells system to not launch more jobs in this batch, but<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>does not stop jobs that are already running.<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>para finished<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>List jobs that have finished<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>para hung<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>List hung jobs in the batch<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>para crashed<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>List jobs that crashed or failed output checks the last time
they <o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>were run.<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>para failed<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>List jobs that crashed after repeated restarts.<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>para problems<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>List jobs that had problems (even if successfully rerun). <o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>Includes host info<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>para running<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>Print info on currently running jobs<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>para time<o:p></o:p></span></p>

<p class=Coding style='margin-left:0in'><span style='font-size:10.0pt'><span
style="mso-spacerun: yes">      </span>List timing information<o:p></o:p></span></p>

<h4>Para Job Lists</h4>

<p class=MsoNormal>Job lists are files with one command per line.<span
style="mso-spacerun: yes">  </span>The following two lines would be a simple
job list:</p>

<p class=MsoNormal><span style="mso-spacerun: yes">    </span>echo hello boss</p>

<p class=MsoNormal><span style="mso-spacerun: yes">    </span>ls -l</p>

<p class=MsoNormal>Job list can have build in checks on either the input or the
output.</p>

<p class=MsoNormal>The overall format for a check is:</p>

<p class=MsoNormal><span style="mso-spacerun: yes">   </span>{check in|out
exists|exists+|line|line+ fileName}</p>

<p class=MsoNormal>this will be replaced by simply fileName when the job is
run.</p>

<p class=MsoNormal>Checks &quot;in&quot; are used to make sure that input files
are correct.</p>

<p class=MsoNormal>Checks &quot;out&quot; are used to make sure that output
files are correct.</p>

<p class=MsoNormal>There are four types of checks:</p>

<p class=MsoNormal><span style="mso-spacerun: yes">   </span>exists - file must
exist</p>

<p class=MsoNormal><span style="mso-spacerun: yes">   </span>exists+ - file
must exist and be non-empty</p>

<p class=MsoNormal><span style="mso-spacerun: yes">   </span>line - file must
end with a complete line</p>

<p class=MsoNormal><span style="mso-spacerun: yes">   </span>line+ - file must
end with a complete line and be non-empty</p>

<p class=MsoNormal>Here's an example of a blat job spec:</p>

<p class=MsoNormal><span style="mso-spacerun: yes">  </span>blat {check in
line+ human.fa} {check in line+ mouse1.fa} {check out line+ hm1.psl}</p>

<p class=MsoNormal><span style="mso-spacerun: yes">  </span>blat {check in
line+ human.fa} {check in line+ mouse2.fa} {check out line+ hm2.psl}</p>

<p class=MsoNormal>Currently it’s not possible to redirect input or output in a
job list.</p>

<h3>gensub2</h3>

<p class=MsoNormal>Generate job submission file from template and two file
lists.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Coding><span style='font-size:10.0pt'>usage:<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">    </span>gensub2 &lt;file list 1&gt; &lt;file list 2&gt; &lt;template
file&gt; &lt;output file&gt;<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>This will substitute each file
in the file lists for $(path1) <o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>and $(path2)in the template
between #LOOP and #ENDLOOP, and write <o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>the results to the output.<span
style="mso-spacerun: yes">  </span>Other substitution variables are:<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">       </span>$(path1)<span style="mso-spacerun: yes">  </span>- full path
name of first file<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">       </span>$(path1)<span style="mso-spacerun: yes">  </span>- full path
name of second file<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span><span style="mso-spacerun: yes">    </span>$(dir1)<span
style="mso-spacerun: yes">   </span>- first directory. Includes trailing slash
if any.<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">       </span>$(dir2)<span style="mso-spacerun: yes">   </span>- second
directory<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">       </span>$(lastDir1) - The last directory in the first path. Includes<o:p></o:p></span></p>

<p class=Coding style='margin-left:1.2in;text-indent:.3in'><span
style='font-size:10.0pt'><span style="mso-spacerun: yes"> </span>trailing slash
if any.<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">       </span>$(lastDir2) - The last directory in the second path. Includes
<o:p></o:p></span></p>

<p class=Coding style='margin-left:1.5in'><span style='font-size:10.0pt'><span
style="mso-spacerun: yes"> </span>trailing slash if any.<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">       </span>$(root1)<span style="mso-spacerun: yes">  </span>- first
file name without directory or extension<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">       </span>$(root2)<span style="mso-spacerun: yes">  </span>- second
file name without directory or extension<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">       </span>$(ext1)<span style="mso-spacerun: yes">   </span>- first
file extension<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">       </span>$(ext2)<span style="mso-spacerun: yes">   </span>- second
file extension<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">       </span>$(file1)<span style="mso-spacerun: yes">  </span>- name
without dir of first file<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">       </span>$(file2)<span style="mso-spacerun: yes">  </span>- name
without dir of second file<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">       </span>$(num1)<span style="mso-spacerun: yes">   </span>- index of
first file in list<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">       </span>$(num2)<span style="mso-spacerun: yes">   </span>- index of
second file in list<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>The &lt;file list 2&gt;
parameter can be 'single' if there is only one file<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>list.<span style="mso-spacerun:
yes">  </span>By default the order is diagonal, meaning if the first list is
ABC and the secon list is abc the combined order is Aa Ba Ab Ca Bb Ac<span
style="mso-spacerun: yes">  </span>Cb Bc Cc.<span style="mso-spacerun: yes"> 
</span>This tends to put the largest jobs first if the file lists are both
sorted by size. The following options can change this:<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">       </span>-group1 - write elements in order Aa Ab Ac Ba Bb Bc Ca Cb Cc<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">       </span>-group2 - write elements in order Aa Ba Ca Ab Bb Cb Ac Bc Cc<o:p></o:p></span></p>

<h3>parasol</h3>

<p class=Coding><span style='font-size:10.0pt'>Parasol is the name given to the
overall system for managing jobs on<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>a computer cluster and to this
specific program.<span style="mso-spacerun: yes">  </span>This program is<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>intended primarily for system
administrators, and some options of this command can only be used if logged in
as root.<span style="mso-spacerun: yes">  </span>Regular users can do a
‘parasol status,’ or any of the ‘parasol list’ commands though, and may find
these useful to find out how busy the computer cluster is.<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=Coding style='margin-left:0in'><span style='font-size:10.0pt'><span
style="mso-spacerun: yes">     </span>parasol add machine machineName
tempDir<span style="mso-spacerun: yes">  </span>- add new machine to pool<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>parasol remove machine machineName<span style="mso-spacerun:
yes">   </span>- remove machine from pool<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>parasol add spoke - add a new spoke daemon<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>parasol [options] add job command-line<span style="mso-spacerun:
yes">  </span>- add job to list<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">         </span>options: -out=out -in=in -dir=dir -results=file -verbose<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>parasol remove job id - remove job of given ID<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>parasol ping [count] - ping hub server to make sure it's alive.<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>parasol remove jobs userName [jobPattern] - remove jobs
submitted<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">         </span>by user that match jobPattern.<span style="mso-spacerun:
yes">  </span>The jobPattern may include<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">         </span>the wildcards ? and *, though these will need to be
preceded<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">         </span>by escapes (‘\’) if run from most shells.<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>parasol list machines - list machines in pool<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>parasol list jobs - list jobs one per line<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>parasol list users – list users one per line<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>parasol list batches – list batches one per line<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>parasol status - print status of machines, jobs, and spokes. <o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h2>ADMINISTRATIVE COMMAND REFERENCE</h2>

<h3>paraHub</h3>

<p class=Coding><span lang=ES style='font-size:10.0pt;mso-ansi-language:ES'>paraHub
- parasol hub server.<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>usage:<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">    </span>paraHub machineList<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>Where machine list is a file
with machine names in the<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>first column, and number of CPUs
in the second column.<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>This file may include additional
columns as well.<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>options:<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">    </span>spokes=N Number of processes that feed jobs to nodes - default
30<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">    </span>jobCheckPeriod=N<span style="mso-spacerun: yes"> 
</span>Minutes between checking on job - default 10<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">    </span>machineCheckPeriod=N Seconds between checking on machine <o:p></o:p></span></p>

<p class=Coding style='margin-left:1.45in;text-indent:-.25in;mso-list:l2 level1 lfo6;
tab-stops:list 1.45in'><![if !supportLists]><span style='font-size:10.0pt;
font-family:"Times New Roman"'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:10.0pt'>default 20<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">    </span>subnet=XXX.YYY.ZZZ Only accept connections from subnet <o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">           </span>(example subnet=192.168)<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">    </span>nextJobId=N Starting job ID number, by default 100,000 past <o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">                </span>last job number used in previous run.<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">    </span>log=logFile Write a log to logFile. Use 'stdout' here for
console<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">    </span>logFlush<span style="mso-spacerun: yes">  </span><span
style="mso-spacerun: yes">  </span>Flush log with every write.<span
style="mso-spacerun: yes">  </span>This will slow down the<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">                </span>system somewhat, but can be useful in debugging.<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">    </span>noResume<span style="mso-spacerun: yes">    </span>Don’t
attempt to reconnect with jobs still running<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">                </span>or recently finished on nodes.<span
style="mso-spacerun: yes">  </span>Used for debugging.<o:p></o:p></span></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h3>paraHubStop</h3>

<p class=Coding><span style='font-size:10.0pt'>paraHubStop - Shut down paraHub
daemon<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>usage:<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">   </span>paraHubStop now<o:p></o:p></span></p>

<h3>paraNode</h3>

<p class=Coding><span lang=ES style='font-size:10.0pt;mso-ansi-language:ES'>paraNode
- parasol node server.<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>usage:<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">    </span>paraNode start<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>options:<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">    </span>log=file - file may be 'stdout' to go to console<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">    </span>umask=022 – file creation mask, defaults to 002<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">          </span>so that files are world readable and group writable.<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">    </span>userPath=bin:bin/i386 User dirs to add to path<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">    </span>sysPath=/sbin:/local/bin System dirs to add to path<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">    </span>hub=host – restict access to connections from hub<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">    </span>cpu=N - Number of CPUs to use.<span style="mso-spacerun: yes"> 
</span>Default 1<o:p></o:p></span></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h3>paraNodeStart</h3>

<p class=Coding><span style='font-size:10.0pt'>paraNodeStart - Start up parasol
node daemons on a list of machines<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>usage:<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">    </span>paraNodeStart machineList<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>where machineList is a file
containing a list of hosts<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>Machine list contains the
following columns:<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">     </span>&lt;name&gt; &lt;number of cpus&gt;<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>It may have other columns as
well<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>options:<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">    </span>exe=/path/to/paranode<span style="mso-spacerun: yes">   
</span><o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">    </span>umask=022 – file creation mask, defaults to 002<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">    </span>userPath=bin:bin/i386 User dirs to add to path<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">    </span>sysPath=/sbin:/local/bin System dirs to add to path<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">    </span>log=/path/to/log/file – this is best on a local disk of node<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">    </span>hub=machineHostingParaHub - nodes will ignore <o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">                            </span>messages from elsewhere<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">    </span>rsh=/path/to/rsh/like/command<o:p></o:p></span></p>

<h3>paraNodeStop</h3>

<p class=Coding><span style='font-size:10.0pt'>paraNodeStop - Shut down parasol
node daemons on a list of machines<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>usage:<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">    </span>paraNodeStop machineList<o:p></o:p></span></p>

<h3>paraNodeStatus</h3>

<p class=Coding><span style='font-size:10.0pt'>paraNodeStatus - Check status of
paraNode on a list of machines<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>usage:<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">    </span>paraStat machineList<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'>options:<o:p></o:p></span></p>

<p class=Coding><span style='font-size:10.0pt'><span style="mso-spacerun:
yes">    </span>-long<span style="mso-spacerun: yes">  </span>List details of
recent and current jobs.<o:p></o:p></span></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

</div>

</body>

</html>
